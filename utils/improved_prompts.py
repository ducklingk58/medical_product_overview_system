#!/usr/bin/env python3
# -*- coding: utf-8 -*-

"""
개선된 프롬프트 템플릿
Ollama의 키워드 구분 및 연관성 파악 능력 향상을 위한 프롬프트들
"""

# 의약품 전문 지식을 포함한 개선된 프롬프트
IMPROVED_SECTION_PROMPTS = {
    "제품 기본 정보": """당신은 의약품 전문가입니다. 다음 정보를 바탕으로 제품 기본 정보를 분석해주세요.

제품명: {product_name}
추출된 키워드: {keywords}

**분석 지침:**
1. 제품명에서 제형(정제, 주사제, 캡슐 등)을 식별하세요
2. 함량 정보(mg, g, ml 등)가 있다면 정확히 파악하세요
3. 경구용/주사용 등 투여 경로를 구분하세요
4. 필름코팅, 장용정 등 특수 제형을 인식하세요

**주의사항:**
- 키워드가 실제로 해당 항목과 관련있는지 컨텍스트를 고려하세요
- 의약품명과 일반 단어를 구분하세요 (예: "아스피린"은 성분명, "정제"는 제형)

다음 JSON 형식으로 응답하세요:
{{
  "제품 기본 정보": "분석된 제품 기본 정보 설명",
  "confidence": 0.85,
  "reasoning": "분석 근거"
}}""",

    "성분 정보": """당신은 의약품 성분 전문가입니다. 다음 정보를 바탕으로 성분 정보를 분석해주세요.

제품명: {product_name}
추출된 키워드: {keywords}

**분석 지침:**
1. 주성분과 첨가제를 구분하세요
2. 함량 정보를 정확히 파악하세요 (mg, g, ml, % 등)
3. 의약품 성분명을 일반 단어와 구분하세요
4. USP, EP, JP 등 품질 기준을 인식하세요

**주의사항:**
- "아스피린"이 부작용으로 언급된 것인지 주성분인지 구분하세요
- 함량 정보가 실제 성분과 연결되는지 확인하세요
- 첨가제(결합제, 희석제 등)를 주성분과 구분하세요

다음 JSON 형식으로 응답하세요:
{{
  "성분 정보": "분석된 성분 정보 설명",
  "confidence": 0.85,
  "reasoning": "분석 근거"
}}""",

    "외형 정보": """당신은 의약품 외형 전문가입니다. 다음 정보를 바탕으로 외형 정보를 분석해주세요.

제품명: {product_name}
추출된 키워드: {keywords}

**분석 지침:**
1. 색상 정보를 정확히 파악하세요 (흰색, 노란색 등)
2. 모양 정보를 구분하세요 (원형, 타원형, 정사각형 등)
3. 각인, 표시, 마크 정보를 인식하세요
4. 크기 정보가 있다면 포함하세요

**주의사항:**
- 색상이 제품 외형인지 포장재 색상인지 구분하세요
- 모양이 제품 자체인지 포장 형태인지 확인하세요
- 각인 정보가 실제 제품에 있는지 확인하세요

다음 JSON 형식으로 응답하세요:
{{
  "외형 정보": "분석된 외형 정보 설명",
  "confidence": 0.85,
  "reasoning": "분석 근거"
}}""",

    "용기 정보": """당신은 의약품 포장 전문가입니다. 다음 정보를 바탕으로 용기 정보를 분석해주세요.

제품명: {product_name}
추출된 키워드: {keywords}

**분석 지침:**
1. 주용기 재질을 파악하세요 (플라스틱, 유리, 알루미늄 등)
2. 용기 형태를 구분하세요 (병, 앰플, 바이알, 블리스터 등)
3. 보조용기 정보가 있다면 포함하세요
4. 포장 형태를 인식하세요 (단위포장, 다중포장 등)

**주의사항:**
- 용기 재질이 실제 주용기인지 확인하세요
- 블리스터, 포일 등이 보조포장인지 주포장인지 구분하세요
- 용기 크기나 용량 정보가 있다면 포함하세요

다음 JSON 형식으로 응답하세요:
{{
  "용기 정보": "분석된 용기 정보 설명",
  "confidence": 0.85,
  "reasoning": "분석 근거"
}}""",

    "개발 이력": """당신은 의약품 개발 전문가입니다. 다음 정보를 바탕으로 개발 이력을 분석해주세요.

제품명: {product_name}
추출된 키워드: {keywords}

**분석 지침:**
1. 제형 개발 근거를 파악하세요
2. 처방 개발 과정을 인식하세요
3. 임상시험 관련 정보를 구분하세요
4. 개발 단계 정보를 파악하세요

**주의사항:**
- 개발 관련 키워드가 실제 개발 과정인지 확인하세요
- 임상시험 정보가 개발 이력에 해당하는지 구분하세요
- 제형 선택 근거가 명확한지 확인하세요

다음 JSON 형식으로 응답하세요:
{{
  "개발 이력": "분석된 개발 이력 설명",
  "confidence": 0.85,
  "reasoning": "분석 근거"
}}""",

    "성능 특성": """당신은 의약품 성능 전문가입니다. 다음 정보를 바탕으로 성능 특성을 분석해주세요.

제품명: {product_name}
추출된 키워드: {keywords}

**분석 지침:**
1. 용출 특성을 파악하세요
2. 붕해 특성을 인식하세요
3. 생체이용률 정보를 구분하세요
4. 안정성 관련 정보를 파악하세요

**주의사항:**
- 성능 관련 키워드가 실제 측정값인지 확인하세요
- 용출/붕해 정보가 구체적인 수치인지 확인하세요
- 안정성 정보가 실제 성능 특성인지 구분하세요

다음 JSON 형식으로 응답하세요:
{{
  "성능 특성": "분석된 성능 특성 설명",
  "confidence": 0.85,
  "reasoning": "분석 근거"
}}""",

    "미생물학적 특성": """당신은 의약품 미생물학 전문가입니다. 다음 정보를 바탕으로 미생물학적 특성을 분석해주세요.

제품명: {product_name}
추출된 키워드: {keywords}

**분석 지침:**
1. 보존제 정보를 파악하세요
2. 멸균 관련 정보를 인식하세요
3. 미생물 제한 정보를 구분하세요
4. 무균성 관련 정보를 파악하세요

**주의사항:**
- 보존제가 실제 사용되는지 확인하세요
- 멸균 정보가 제품 특성인지 확인하세요
- 미생물 관련 키워드가 실제 특성인지 구분하세요

다음 JSON 형식으로 응답하세요:
{{
  "미생물학적 특성": "분석된 미생물학적 특성 설명",
  "confidence": 0.85,
  "reasoning": "분석 근거"
}}"""
}

# 컨텍스트 분석을 위한 프롬프트
CONTEXT_ANALYSIS_PROMPT = """당신은 의약품 문서 분석 전문가입니다. 다음 텍스트에서 키워드의 컨텍스트를 분석해주세요.

텍스트: {text}
분석할 키워드: {keyword}

**분석 지침:**
1. 키워드가 어떤 맥락에서 사용되었는지 파악하세요
2. 키워드가 긍정적/부정적 의미인지 구분하세요
3. 키워드가 실제 제품 특성인지 확인하세요
4. 키워드의 신뢰도를 평가하세요 (0.0-1.0)

**응답 형식:**
{{
  "context": "키워드 사용 맥락",
  "sentiment": "positive/negative/neutral",
  "relevance": "high/medium/low",
  "confidence": 0.85,
  "reasoning": "분석 근거"
}}"""

# 키워드 연관성 분석 프롬프트
KEYWORD_RELATIONSHIP_PROMPT = """당신은 의약품 키워드 연관성 분석 전문가입니다. 다음 키워드들 간의 관계를 분석해주세요.

제품명: {product_name}
키워드 목록: {keywords}

**분석 지침:**
1. 키워드들 간의 의미적 연관성을 파악하세요
2. 동의어나 유사어를 그룹화하세요
3. 상위-하위 개념 관계를 구분하세요
4. 키워드의 중요도를 평가하세요

**응답 형식:**
{{
  "keyword_groups": [
    {{
      "group_name": "그룹명",
      "keywords": ["키워드1", "키워드2"],
      "relationship": "관계 설명",
      "importance": "high/medium/low"
    }}
  ],
  "overall_analysis": "전체 키워드 분석 결과"
}}""" 